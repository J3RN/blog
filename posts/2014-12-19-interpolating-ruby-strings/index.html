<!doctype html><html lang=en-us dir=ltr class=scroll-smooth data-default-appearance=light data-auto-appearance=true><head>
<meta charset=utf-8>
<meta http-equiv=content-language content="en-us">
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="ie=edge">
<title>Interpolating Ruby Strings &#183; J3RN's Blog</title><meta name=title content="Interpolating Ruby Strings &#183; J3RN's Blog">
<meta name=description content="My technical blog where I write about Ruby, Elixir, software architecture, software development methodologies, and programming language design.">
<link rel=canonical href=http://j3rn.com/posts/2014-12-19-interpolating-ruby-strings/>
<link type=text/css rel=stylesheet href=/css/main.bundle.min.99f98c53cf271b9db0827426f7c35174a5915fc431b6dae812a8ddda785ed7e3a525215d0e5f85378931d5b96b11751cbbbfaaf45c07a9c4a4b668935a9df524.css integrity="sha512-mfmMU88nG52wgnQm98NRdKWRX8QxttroEqjd2nhe1+OlJSFdDl+FN4kx1blrEXUcu7+q9FwHqcSktmiTWp31JA==">
<script type=text/javascript src=/js/appearance.min.12e98742cd283574d030a7fe55f29597df4ee214f7ff7075b4d19a64d046a602753c715295550be7899b661619cec89c679049d36c624681671a8013c1249896.js integrity="sha512-EumHQs0oNXTQMKf+VfKVl99O4hT3/3B1tNGaZNBGpgJ1PHFSlVUL54mbZhYZzsicZ5BJ02xiRoFnGoATwSSYlg=="></script>
<link rel=icon type=image/png sizes=32x32 href=/images/favicon.ico>
<meta property="og:title" content="Interpolating Ruby Strings">
<meta property="og:description" content="Sometimes I want string templates that I can pass around. In this post, I discuss how this can be accomplished in Ruby.
">
<meta property="og:type" content="article">
<meta property="og:url" content="http://j3rn.com/posts/2014-12-19-interpolating-ruby-strings/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2014-12-19T22:14:25-05:00">
<meta property="article:modified_time" content="2014-12-19T22:14:25-05:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Interpolating Ruby Strings">
<meta name=twitter:description content="Sometimes I want string templates that I can pass around. In this post, I discuss how this can be accomplished in Ruby.
">
<script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"Interpolating Ruby Strings","headline":"Interpolating Ruby Strings","description":"Sometimes I want string templates that I can pass around. In this post, I discuss how this can be accomplished in Ruby.\n","abstract":"Let\u0026rsquo;s talk about interpolation. Sure, you probably know the Ruby string interpolation syntax:\narg = \u0026#34;world\u0026#34; puts \u0026#34;Hello #{arg}!\u0026#34; #=\u0026gt; \u0026#34;Hello world!\u0026#34; This syntax is pretty useful. However, it has it\u0026rsquo;s limitations. Let\u0026rsquo;s say that we are generating strings that are almost the same each time, but with each, one word changes. How are you going to do this now?\nMy first inclination was something like this:\nline = \u0026#34;Today the weather is \\#{ weather }\u0026#34; weather_conditions = {}  [\u0026#34;warm\u0026#34;, \u0026#34;cloudy\u0026#34;, \u0026#34;windy\u0026#34;].","inLanguage":"en-us","url":"http:\/\/j3rn.com\/posts\/2014-12-19-interpolating-ruby-strings\/","author":{"@type":"Person","name":"Jonathan Arnett"},"copyrightYear":"2014","dateCreated":"2014-12-19T22:14:25-05:00","datePublished":"2014-12-19T22:14:25-05:00","dateModified":"2014-12-19T22:14:25-05:00","keywords":["ruby","interpolation"],"mainEntityOfPage":"true","wordCount":"221"}]</script>
<meta name=author content="Jonathan Arnett">
<script defer data-domain=j3rn.com src=https://plausible.io/js/plausible.js></script>
</head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 bg-neutral text-neutral-900 sm:px-14 md:px-24 lg:px-32 dark:bg-neutral-800 dark:text-neutral max-w-7xl">
<div id=the-top class="absolute flex self-center">
<a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 dark:bg-neutral-600 focus:translate-y-0" href=#main-content><span class="font-bold ltr:pr-2 rtl:pl-2 text-primary-600 dark:text-primary-400">&darr;</span>Skip to main content</a>
</div><header class="py-6 font-semibold sm:py-10 text-neutral-900 dark:text-neutral print:hidden">
<nav class="flex justify-between">
<div>
<a href=/>
<img src=/avatar.png width=250 height=250 class="max-w-[2rem] max-h-[2rem] mr-1 object-scale-down object-left rounded inline-block" alt="J3RN's Blog">
</a>
<a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" rel=me href=/>J3RN&rsquo;s Blog</a>
</div><ul class="flex flex-col list-none ltr:text-right rtl:text-left sm:flex-row">
<li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
<a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/tags/ title=Tags>Tags</a>
</li></ul></nav></header><div class="relative flex flex-col grow">
<main id=main-content class=grow>
<article>
<header class=max-w-prose>
<h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
Interpolating Ruby Strings
</h1><div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
<div class="flex flex-row flex-wrap items-center">
<time datetime="2014-12-19 22:14:25 -0500 -0500">December 19, 2014</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">2 mins</span>
</div></div></header><section class="flex flex-col max-w-full mt-0 prose lg:flex-row dark:prose-invert">
<div class="min-w-0 min-h-0 max-w-prose">
<p>Let&rsquo;s talk about interpolation. Sure, you probably know the Ruby string interpolation syntax:</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span><span style=color:#c1abea>arg</span> <span style=color:#c7bf54>=</span> <span style=color:#63c381>&#34;world&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ef8383>puts</span> <span style=color:#63c381>&#34;Hello </span><span style=color:#98c379>#{</span><span style=color:#c1abea>arg</span><span style=color:#98c379>}</span><span style=color:#63c381>!&#34;</span> <span style=color:#8a93a5;font-style:italic>#=&gt; &#34;Hello world!&#34;</span>
</span></span></code></pre></div><p>This syntax is pretty useful. However, it has it&rsquo;s limitations. Let&rsquo;s say that we are generating strings that are almost the same each time, but with each, one word changes. How are you going to do this now?</p><p>My first inclination was something like this:</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span><span style=color:#c1abea>line</span> <span style=color:#c7bf54>=</span> <span style=color:#63c381>&#34;Today the weather is </span><span style=color:#d26464;font-weight:700>\#</span><span style=color:#63c381>{ weather }&#34;</span>
</span></span><span style=display:flex><span><span style=color:#c1abea>weather_conditions</span> <span style=color:#c7bf54>=</span> {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c7bf54>[</span><span style=color:#63c381>&#34;warm&#34;</span>, <span style=color:#63c381>&#34;cloudy&#34;</span>, <span style=color:#63c381>&#34;windy&#34;</span><span style=color:#c7bf54>].</span><span style=color:#c1abea>each</span> <span style=color:#c678dd>do</span> <span style=color:#c7bf54>|</span><span style=color:#c1abea>weather</span><span style=color:#c7bf54>|</span>
</span></span><span style=display:flex><span>  <span style=color:#c1abea>weather_conditions</span><span style=color:#c7bf54>[</span><span style=color:#c1abea>weather</span><span style=color:#c7bf54>]</span> <span style=color:#c7bf54>=</span> <span style=color:#98c379>%r/line/i</span>
</span></span><span style=display:flex><span><span style=color:#c678dd>end</span>
</span></span></code></pre></div><p>It&rsquo;s not hard to see why this didn&rsquo;t work. Well, it occurred to me shortly thereafter that ERB might be the right way to go with this.</p><p>First try with ERB:</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span><span style=color:#c1abea>line</span> <span style=color:#c7bf54>=</span> <span style=color:#63c381>&#34;Today the weather is &lt;%= weather %&gt;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#c1abea>weather_conditions</span> <span style=color:#c7bf54>=</span> {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c7bf54>[</span><span style=color:#63c381>&#34;warm&#34;</span>, <span style=color:#63c381>&#34;cloudy&#34;</span>, <span style=color:#63c381>&#34;windy&#34;</span><span style=color:#c7bf54>].</span><span style=color:#c1abea>each</span> <span style=color:#c678dd>do</span> <span style=color:#c7bf54>|</span><span style=color:#c1abea>weather</span><span style=color:#c7bf54>|</span>
</span></span><span style=display:flex><span>  <span style=color:#c1abea>weather_conditions</span><span style=color:#c7bf54>[</span><span style=color:#c1abea>weather</span><span style=color:#c7bf54>]</span> <span style=color:#c7bf54>=</span> <span style=color:#b756ff;font-weight:700>ERB</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>new</span>(<span style=color:#c1abea>line</span>)<span style=color:#c7bf54>.</span><span style=color:#c1abea>result</span>
</span></span><span style=display:flex><span><span style=color:#c678dd>end</span>
</span></span></code></pre></div><p>This endeavor, however, resulted in the following error:</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>NameError - undefined <span style=color:#ef8383>local</span> variable or method <span style=color:#98c379>`</span>weather&#39; <span style=color:#c678dd>for</span> main:Object:
</span></span></code></pre></div><p>After some searching about on the internet, it appears that there is an ever-present <code>binding</code> variable, that is an instance of the <code>Binding</code> class. Strange as that was, it seems to be needed by <code>ERB.new</code> to properly interpolate variables.</p><p>The final code:</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span><span style=color:#c1abea>line</span> <span style=color:#c7bf54>=</span> <span style=color:#63c381>&#34;Today the weather is &lt;%= weather %&gt;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#c1abea>weather_conditions</span> <span style=color:#c7bf54>=</span> {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c7bf54>[</span><span style=color:#63c381>&#34;warm&#34;</span>, <span style=color:#63c381>&#34;cloudy&#34;</span>, <span style=color:#63c381>&#34;windy&#34;</span><span style=color:#c7bf54>].</span><span style=color:#c1abea>each</span> <span style=color:#c678dd>do</span> <span style=color:#c7bf54>|</span><span style=color:#c1abea>weather</span><span style=color:#c7bf54>|</span>
</span></span><span style=display:flex><span>  <span style=color:#c1abea>weather_conditions</span><span style=color:#c7bf54>[</span><span style=color:#c1abea>weather</span><span style=color:#c7bf54>]</span> <span style=color:#c7bf54>=</span> <span style=color:#b756ff;font-weight:700>ERB</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>new</span>(<span style=color:#c1abea>line</span>)<span style=color:#c7bf54>.</span><span style=color:#c1abea>result</span>(<span style=color:#ef8383>binding</span>)
</span></span><span style=display:flex><span><span style=color:#c678dd>end</span>
</span></span></code></pre></div></div></section><footer class="pt-8 max-w-prose print:hidden">
<div class=pt-8>
<hr class="border-dotted border-neutral-300 dark:border-neutral-600">
<div class="flex justify-between pt-3">
<span>
<a class="flex group" href=/posts/2014-01-12-number-windowsprobs/>
<span class="mr-3 ltr:inline rtl:hidden text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400">&larr;</span>
<span class="ml-3 ltr:hidden rtl:inline text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400">&rarr;</span>
<span class="flex flex-col">
<span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">#WindowsProbs</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
<time datetime="2014-01-12 17:06:21 -0500 -0500">January 12, 2014</time>
</span>
</span>
</a>
</span>
<span>
<a class="flex text-right group" href=/posts/2016-01-13-rage-against-the-unintelligent-machine/>
<span class="flex flex-col">
<span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Rage Against the Unintelligent Machine</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
<time datetime="2016-01-13 10:08:00 -0500 -0500">January 13, 2016</time>
</span>
</span>
<span class="ml-3 ltr:inline rtl:hidden text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400">&rarr;</span>
<span class="mr-3 ltr:hidden rtl:inline text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400">&larr;</span>
</a>
</span>
</div></div></footer></article><div class="absolute top-[100vh] ltr:right-0 rtl:left-0 w-12 pointer-events-none bottom-0">
<a href=#the-top class="w-12 h-12 sticky pointer-events-auto top-[calc(100vh-5.5rem)] bg-neutral/50 dark:bg-neutral-800/50 backdrop-blur rounded-full text-xl flex items-center justify-center text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">
&uarr;
</a>
</div></main><footer class="py-10 print:hidden">
<div class="flex items-center justify-between">
<div>
<p class="text-sm text-neutral-500 dark:text-neutral-400">
&copy;
2022
Jonathan Arnett
</p><p class="text-xs text-neutral-500 dark:text-neutral-400">
Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://git.io/hugo-congo target=_blank rel="noopener noreferrer">Congo</a>
</p></div></div></footer></div></body></html>