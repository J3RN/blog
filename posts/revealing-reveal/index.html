<!doctype html><html lang=en-us dir=ltr class=scroll-smooth data-default-appearance=light data-auto-appearance=true><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#FFFFFF"><title>Revealing Reveal &#183; J3RN's Blog</title><meta name=title content="Revealing Reveal &#183; J3RN's Blog"><script type=text/javascript src=/js/appearance.min.74ad8406faea02f3e186ba5126249aaeed9073629e04b05037b903396b188724.js integrity="sha256-dK2EBvrqAvPhhrpRJiSaru2Qc2KeBLBQN7kDOWsYhyQ="></script>
<link type=text/css rel=stylesheet href=/css/main.bundle.min.0a4c76250260480a94ada35e0102ccba16da18a04924849ac68684f3e52516cc.css integrity="sha256-Ckx2JQJgSAqUraNeAQLMuhbaGKBJJISaxoaE8+UlFsw="><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.edd493141e4685ddc2547cda5c54adf770e06fe7d1043272b49d9fcd8a204ecc.js integrity="sha256-7dSTFB5Ghd3CVHzaXFSt93Dgb+fRBDJytJ2fzYogTsw=" data-copy=Copy data-copied=Copied></script><meta name=description content="
      An alternate approach for conveying syntactic information to programmers.
    "><link rel=canonical href=http://j3rn.com/posts/revealing-reveal/><link rel=icon type=image/png sizes=32x32 href=/images/favicon.ico><meta property="og:title" content="Revealing Reveal"><meta property="og:description" content="An alternate approach for conveying syntactic information to programmers."><meta property="og:type" content="article"><meta property="og:url" content="http://j3rn.com/posts/revealing-reveal/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-17T00:00:00+00:00"><meta property="article:modified_time" content="2024-11-17T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Revealing Reveal"><meta name=twitter:description content="An alternate approach for conveying syntactic information to programmers."><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"Revealing Reveal","headline":"Revealing Reveal","description":"An alternate approach for conveying syntactic information to programmers.","abstract":"Disclaimer: A limitation of the work that I\u0026rsquo;m describing in this post is that it may only be useful to sighted persons and is enhanced by being not colorblind. This post discusses a tool that displays code within colored boxes. The current implementation provides titles on the boxes which might be of use to those without (color) vision, but I have not verified it with a screen reader. I will strive in my future work to create tools that are of use to the (color)blind community.","inLanguage":"en-us","url":"http:\/\/j3rn.com\/posts\/revealing-reveal\/","author":{"@type":"Person","name":"Jonathan Arnett"},"copyrightYear":"2024","dateCreated":"2024-11-17T00:00:00\u002b00:00","datePublished":"2024-11-17T00:00:00\u002b00:00","dateModified":"2024-11-17T00:00:00\u002b00:00","keywords":["software development","tree-sitter"],"mainEntityOfPage":"true","wordCount":"731"}</script><meta name=author content="Jonathan Arnett"><link href=https://fosstodon.org/@j3rn rel=me><script defer data-domain=j3rn.com data-api=https://plausible.io/api/event src=https://plausible.io/js/script.js></script></head><body class="m-auto flex h-screen max-w-7xl flex-col bg-neutral px-6 text-lg leading-7 text-neutral-900 sm:px-14 md:px-24 lg:px-32 dark:bg-neutral-800 dark:text-neutral"><div id=the-top class="absolute flex self-center"><a class="-translate-y-8 rounded-b-lg bg-primary-200 px-3 py-1 text-sm focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="pe-2 font-bold text-primary-600 dark:text-primary-400">&darr;</span>Skip to main content</a></div><header class="py-6 font-semibold text-neutral-900 print:hidden sm:py-10 dark:text-neutral"><nav class="flex items-start justify-between sm:items-center"><div class="flex flex-row items-center"><a href=/ class=mr-2><img src=/avatar.png width=43 height=43 class="max-h-[10rem] max-w-[10rem] object-scale-down object-left" alt="J3RN's Blog"></a>
<a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" rel=me href=/>J3RN&rsquo;s Blog</a></div><ul class="flex list-none flex-col text-end sm:flex-row"><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5"><a href=/index.xml title="RSS Feed"><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"><span class="icon relative inline-block align-text-bottom"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M0 64C0 46.3 14.3 32 32 32c229.8.0 416 186.2 416 416 0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96 14.3 96 0 81.7.0 64zM0 416a64 64 0 11128 0A64 64 0 110 416zM32 160c159.1.0 288 128.9 288 288 0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224-17.7.0-32-14.3-32-32s14.3-32 32-32z"/></svg></span></span></a></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5"><a href=https://fosstodon.org/@j3rn title="@J3RN on Fosstodon (a Mastodon server)" rel=me><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"><span class="icon relative inline-block align-text-bottom"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48.0.0.0-63.72 28.5-63.72 125.7.0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54.0 01-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg></span></span></a></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5"><a href=/portfolio/ title=Portfolio><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Portfolio</span></a></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5"><a href=/tags/ title=Tags><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Tags</span></a></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0"><button id=search-button-m0 title="Search (/)">
<span class="group-dark:hover:text-primary-400 transition-colors group-hover:text-primary-600"><span class="icon relative inline-block px-1 align-text-bottom"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></span></button></li></ul></nav></header><div class="relative flex grow flex-col"><main id=main-content class=grow><article><header class=max-w-prose><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Revealing Reveal</h1><div class="mb-12 mt-8 text-base text-neutral-500 print:hidden dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime="2024-11-17 00:00:00 +0000 UTC">November 17, 2024</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">4 mins</span></div><div class="my-1 flex flex-wrap text-xs leading-relaxed text-neutral-500 dark:text-neutral-400"><a href=/tags/software-development/ class="mx-1 my-1 rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400">software development</a>
<a href=/tags/tree-sitter/ class="mx-1 my-1 rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400">tree-sitter</a></div></div></header><section class="prose mt-0 flex max-w-full flex-col dark:prose-invert lg:flex-row"><div class="min-h-0 min-w-0 max-w-prose grow"><p><strong>Disclaimer: A limitation of the work that I&rsquo;m describing in this post is that it may only be useful to sighted persons and is enhanced by being not colorblind. This post discusses a tool that displays code within colored boxes. The current implementation provides titles on the boxes which might be of use to those without (color) vision, but I have not verified it with a screen reader. I will strive in my future work to create tools that are of use to the (color)blind community.</strong></p><p>Over the last several years, I&rsquo;ve been intrigued by <em>projectional editors</em>, or editors that are aware of syntactic (and optionally semantic) constraints of what they&rsquo;re being used to create. There are some reasonably good examples; for instance, rich text fields in websites ultimately generate HTML markup, but their user interfaces hide the markup and instead provide buttons like &ldquo;<strong>Bold</strong>&rdquo; that seamlessly insert markup that the user never sees. However, editors for writing software are notably lacking in this regard. Sure, modern editors have a litany of helpful features, but few actually prevent you from making trivial syntactic errors such as forgetting a semicolon.</p><p>After years of research into this field, I set out to build a projectional editor for code, analogous to <a href=https://github.com/disconcision/fructure target=_blank rel=noreferrer>Fructure</a> (pictured below) (see also: <a href="https://www.youtube.com/watch?v=CnbVCNIh1NA" target=_blank rel=noreferrer>Andrew Blinn&rsquo;s talk on Fructure at RacketCon</a>). &ldquo;How hard could it be?&rdquo; I thought. It turns out: it&rsquo;s pretty hard.</p><p><figure><img src=/images/fructure.png alt="Racket code partially represented by text in colored boxes." class="mx-auto my-0 rounded-md"></figure></p><p>Creating a projectional editor was so hard in fact that my first attempt went so sideways as to not be a projectional editor at all, but something totally different: <a href=https://j3rn.com/reveal target=_blank rel=noreferrer>Reveal</a>.</p><p><figure><img src=/images/Reveal.png alt="Python code represented as text within nested, colored boxes.  Each syntactic construct is the same color (e.g. integers are cyan)." class="mx-auto my-0 rounded-md"></figure></p><p>A feature of Fructure that I absolutely loved was the way that different syntactic structures were encased in colored boxes. In the screenshot above, <code>true</code> is always in a green box. The condition is always blue. This immediately reveals (to sighted, non-colorblind persons) a great deal of information at a glance. It also triggered an epiphany: text highlighting isn&rsquo;t good enough because it fails to show the <em>extent</em> of syntactic forms.</p><p><figure><img src=/images/arrow_function.png alt="A JavaScript arrow function in an editor with traditional syntax highlighting." class="mx-auto my-0 rounded-md"></figure></p><p>JavaScript&rsquo;s &ldquo;arrow functions&rdquo; became the poster child of this phenomenon for me. In my work mentoring new developers, this syntax frequently confused them; there is no clear indication that the arguments (<code>(...)</code>) and body (<code>{ ... }</code>) are necessarily part of the same syntactic structure.</p><p><figure><img src=/images/reveal_arrow_function.png alt="Reveal, where the JavaScript arrow function is wrapped in a purple box labeled &amp;ldquo;arrow function&amp;rdquo;." class="mx-auto my-0 rounded-md"></figure></p><p>The key insight of Reveal is to, like Fructure, <em>wrap</em> syntactic structures to show their extent in addition to their &ldquo;type&rdquo; (e.g. variable, function, etc), whereas (good) syntax highlighting can only convey the general &ldquo;type&rdquo; of text it represents.</p><h2 id=why-reveal-is-no-good class="relative group">Why Reveal is No Good <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#why-reveal-is-no-good aria-label=Anchor>#</a></span></h2><p>Problem solved, right? Well, not quite.</p><p>There are at least two large problems with Reveal; feel free to <a href=https://fosstodon.org/@j3rn target=_blank rel=noreferrer>tell me more</a> as you find/think of them.</p><ol><li><p>Multi-line structures look terrible<figure><img src=/images/reveal_multi_line.png alt="Reveal showing an Elixir module declaration, but the name of the module is rendered to the left of a large block containing the body of the module." class="mx-auto my-0 rounded-md"></figure></p><p>This issue is, conceivably, solvable. My intention here is to make multi-line syntactic structures wrap such that the rendered Reveal version of the code closely resembles the text version.</p><p><figure><img src=/images/reveal_concept2.png alt="A mockup where an Elixir function&amp;rsquo;s body is wrapped such that its name is above the body." class="mx-auto my-0 rounded-md"></figure>(Pardon the really garish colors, this was a &ldquo;quick and dirty&rdquo; mockup)</p><p>I came to believe that HTML and CSS, the tools currently rendering Reveal, are not capable of rending this, and so I began work on <a href=https://github.com/J3RN/reveal/blob/main/svg_renderer.js target=_blank rel=noreferrer>an SVG renderer</a>. Work on that has been limited.</p></li><li><p>Information overload</p><p>In conversations with people about Reveal, I usually frame its utility as &ldquo;conveying a greater amount of information&rdquo; than, say, conventional syntax highlighting. As mentioned before, Reveal conveys strictly more information by conveying the extent‚Äîin addition to the &ldquo;type&rdquo;‚Äîof syntactic structures. This is, evidently, a double-edged sword. Consider again the JavaScript example from earlier:</p><p><figure><img src=/images/reveal_arrow_function.png alt="Reveal, where the JavaScript arrow function is wrapped in a purple box labeled &amp;ldquo;arrow function&amp;rdquo;.  The body of the arrow function is wrapped in alternating yellow and green boxes." class="mx-auto my-0 rounded-md"></figure></p><p>The alternating yellow and green boxes in the function body create a great deal of visual noise. Here, the yellow boxes represent function application (grouping a callee with arguments) and the green boxes represent field access (e.g. <code>document.querySelector</code>). I am reminded of the saying &ldquo;If everything is important, nothing is important&rdquo;. Here, the JavaScript is syntactically dense, resulting in a large volume of syntax annotation. But is all the annotation worthwhile? Are these yellow and green boxes helping anyone, or just getting in the way? Can we simply train our brains to ignore the information we don&rsquo;t care about but not the information we need?</p><p>These are worthy questions, and I don&rsquo;t have answers to any of them.</p></li></ol><p>In any event, I hope my work and discussion thereof helps you in your endeavors. And, if you want to finish my SVG renderer, <a href=https://github.com/J3RN/reveal target=_blank rel=noreferrer>pull requests are welcome</a>! üôè</p></div></section><footer class="max-w-prose pt-8 print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="group flex" href=/posts/javascript-prefer-then/><span class="me-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"><span class="ltr:inline rtl:hidden">&larr;</span><span class="ltr:hidden rtl:inline">&rarr;</span></span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Why I Still Use JavaScript's then</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2024-09-04 00:00:00 +0000 UTC">September 4, 2024</time></span></span></a></span>
<span></span></div></div></footer></article><div class="pointer-events-none absolute bottom-0 end-0 top-[100vh] w-12"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer class="py-10 print:hidden"><div class="flex items-center justify-between"><div><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2025
Jonathan Arnett</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://github.com/jpanther/congo target=_blank rel="noopener noreferrer">Congo</a></p></div><div class="flex flex-row items-center"><div class="me-14 cursor-pointer text-sm text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"><button id=appearance-switcher-0 type=button aria-label="appearance switcher"><div class="flex h-12 w-12 items-center justify-center dark:hidden" title="Switch to dark appearance"><span class="icon relative inline-block px-1 align-text-bottom"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="hidden h-12 w-12 items-center justify-center dark:flex" title="Switch to light appearance"><span class="icon relative inline-block px-1 align-text-bottom"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div></div></footer><div id=search-wrapper class="invisible fixed inset-0 z-50 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm sm:p-6 md:p-[10vh] lg:p-[12vh] dark:bg-neutral-900/50" data-url=http://j3rn.com/><div id=search-modal class="top-20 mx-auto flex min-h-0 w-full max-w-3xl flex-col rounded-md border border-neutral-200 bg-neutral shadow-lg dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex flex-none items-center justify-between px-2"><form class="flex min-w-0 flex-auto items-center"><div class="flex h-8 w-8 items-center justify-center text-neutral-400"><span class="icon relative inline-block px-1 align-text-bottom"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="mx-1 flex h-12 flex-auto appearance-none bg-transparent focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex h-8 w-8 items-center justify-center text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="icon relative inline-block px-1 align-text-bottom"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto overflow-auto px-2"><ul id=search-results></ul></section></div></div></div></body></html>