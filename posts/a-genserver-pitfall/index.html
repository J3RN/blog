<!doctype html><html lang=en-us dir=ltr class=scroll-smooth data-default-appearance=light data-auto-appearance=true><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#FFFFFF"><title>Avoiding a GenServer Pitfall &#183; J3RN's Blog</title><meta name=title content="Avoiding a GenServer Pitfall &#183; J3RN's Blog"><script type=text/javascript src=https://j3rn.com/js/appearance.min.8a082f81b27f3cb2ee528df0b0bdc39787034cf2cc34d4669fbc9977c929023c.js integrity="sha256-iggvgbJ/PLLuUo3wsL3Dl4cDTPLMNNRmn7yZd8kpAjw="></script><link type=text/css rel=stylesheet href=https://j3rn.com/css/main.bundle.min.e95065750dd72261447181fe3d591abd5a742a44c43f792b86f74ed607263357.css integrity="sha256-6VBldQ3XImFEcYH+PVkavVp0KkTEP3krhvdO1gcmM1c="><script defer type=text/javascript id=script-bundle src=https://j3rn.com/js/main.bundle.min.85588ca4a09487934eca6830f4d8ec6b443b96cf1895ddf10249e8f2ddddeb74.js integrity="sha256-hViMpKCUh5NOymgw9Njsa0Q7ls8Yld3xAkno8t3d63Q=" data-copy=Copy data-copied=Copied></script><meta name=description content="
      An overview of what GenServers do, and things can go awry.
    "><link rel=canonical href=https://j3rn.com/posts/a-genserver-pitfall/><link rel=icon type=image/png sizes=32x32 href=/images/favicon.ico><meta property="og:url" content="https://j3rn.com/posts/a-genserver-pitfall/"><meta property="og:site_name" content="J3RN's Blog"><meta property="og:title" content="Avoiding a GenServer Pitfall"><meta property="og:description" content="An overview of what GenServers do, and things can go awry."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-11-01T00:00:00+00:00"><meta property="article:modified_time" content="2025-11-01T00:00:00+00:00"><meta property="article:tag" content="Elixir"><meta property="article:tag" content="Erlang"><meta name=twitter:card content="summary"><meta name=twitter:title content="Avoiding a GenServer Pitfall"><meta name=twitter:description content="An overview of what GenServers do, and things can go awry."><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"Avoiding a GenServer Pitfall","headline":"Avoiding a GenServer Pitfall","description":"An overview of what GenServers do, and things can go awry.","abstract":"\u003ch1 id=\u0022firstly-what-is-a-genserver\u0022 class=\u0022relative group\u0022\u003eFirstly, what is a GenServer? \u003cspan class=\u0022absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\u0022\u003e\u003ca class=\u0022group-hover:text-primary-300 dark:group-hover:text-neutral-700\u0022 style=\u0022text-decoration-line: none !important;\u0022 href=\u0022#firstly-what-is-a-genserver\u0022 aria-label=\u0022Anchor\u0022\u003e#\u003c\/a\u003e\u003c\/span\u003e\u003c\/h1\u003e\u003cp\u003eGenServer, short for \u0026ldquo;generic server\u0026rdquo;, is a type of process within BEAM (Erlang, Elixir) applications that can hold state and respond to requests; much like a web server, in a way.  For instance, you could create a GenServer that you could handle requests to store blog posts as well as other requests to list or read those blog posts—but those request would have to be made within the BEAM VM rather than with a web browser.  Within BEAM applications, the two primary purposes of GenServers are to execute code asynchronously and act as a store of shared, mutable state.\u003c\/p\u003e","inLanguage":"en-us","url":"https:\/\/j3rn.com\/posts\/a-genserver-pitfall\/","author":{"@type":"Person","name":"Jonathan Arnett"},"copyrightYear":"2025","dateCreated":"2025-11-01T00:00:00\u002b00:00","datePublished":"2025-11-01T00:00:00\u002b00:00","dateModified":"2025-11-01T00:00:00\u002b00:00","keywords":["elixir","erlang"],"mainEntityOfPage":"true","wordCount":"1974"}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://j3rn.com/","name":"J3 Rn's Blog","position":1},{"@type":"ListItem","item":"https://j3rn.com/posts/","name":"Posts","position":2},{"@type":"ListItem","name":"Avoiding a Gen Server Pitfall","position":3}]}</script><meta name=author content="Jonathan Arnett"><link href=https://fosstodon.org/@j3rn rel=me><script defer data-domain=j3rn.com data-api=https://plausible.io/api/event src=https://plausible.io/js/script.js></script></head><body class="m-auto flex h-screen max-w-7xl flex-col bg-neutral px-6 text-lg leading-7 text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"><div id=the-top class="absolute flex self-center"><a class="-translate-y-8 rounded-b-lg bg-primary-200 px-3 py-1 text-sm focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="pe-2 font-bold text-primary-600 dark:text-primary-400">&darr;</span>Skip to main content</a></div><header class="py-6 font-semibold text-neutral-900 dark:text-neutral sm:py-10 print:hidden"><nav class="flex items-start justify-between sm:items-center"><div class="flex flex-row items-center"><a href=/ class=mr-2><img src=https://j3rn.com/avatar.png width=43 height=43 class="max-h-[10rem] max-w-[10rem] object-scale-down object-left" alt="J3RN's Blog">
</a><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" rel=me href=/>J3RN&rsquo;s Blog</a></div><ul class="flex list-none flex-col text-end sm:flex-row"><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5"><a href=/index.xml title="RSS Feed"><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"><span class="icon relative inline-block align-text-bottom"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 64C0 46.3 14.3 32 32 32c229.8.0 416 186.2 416 416 0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96 14.3 96 0 81.7.0 64zM0 416a64 64 0 11128 0A64 64 0 110 416zM32 160c159.1.0 288 128.9 288 288 0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224-17.7.0-32-14.3-32-32s14.3-32 32-32z"/></svg></span></span></a></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5"><a href=https://fosstodon.org/@j3rn title="@J3RN on Fosstodon (a Mastodon server)" rel=me><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"><span class="icon relative inline-block align-text-bottom"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48.0.0.0-63.72 28.5-63.72 125.7.0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54.0 01-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg></span></span></a></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5"><a href=/portfolio/ title=Portfolio><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Portfolio</span></a></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5"><a href=/tags/ title=Tags><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Tags</span></a></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0"><button id=search-button-m0 title="Search (/)">
<span class="group-dark:hover:text-primary-400 transition-colors group-hover:text-primary-600"><span class="icon relative inline-block px-1 align-text-bottom"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></span></button></li></ul></nav></header><div class="relative flex grow flex-col"><main id=main-content class=grow><article><header class=max-w-prose><h1 class="mb-8 mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Avoiding a GenServer Pitfall</h1><div class="mb-10 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime="2025-11-01 00:00:00 +0000 UTC">November 1, 2025</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">10 mins</span></div><div class="my-1 flex flex-wrap text-xs leading-relaxed text-neutral-500 dark:text-neutral-400"><a href=https://j3rn.com/tags/elixir/ class="mx-1 my-1 rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400">Elixir</a>
<a href=https://j3rn.com/tags/erlang/ class="mx-1 my-1 rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400">Erlang</a></div></div></header><section class="prose mt-0 flex max-w-full flex-col dark:prose-invert lg:flex-row"><div class="min-h-0 min-w-0 max-w-prose grow"><h1 id=firstly-what-is-a-genserver class="relative group">Firstly, what is a GenServer? <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#firstly-what-is-a-genserver aria-label=Anchor>#</a></span></h1><p>GenServer, short for &ldquo;generic server&rdquo;, is a type of process within BEAM (Erlang, Elixir) applications that can hold state and respond to requests; much like a web server, in a way. For instance, you could create a GenServer that you could handle requests to store blog posts as well as other requests to list or read those blog posts—but those request would have to be made within the BEAM VM rather than with a web browser. Within BEAM applications, the two primary purposes of GenServers are to execute code asynchronously and act as a store of shared, mutable state.</p><h2 id=executing-code-asynchronously class="relative group">Executing Code Asynchronously <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#executing-code-asynchronously aria-label=Anchor>#</a></span></h2><p>One way to use a GenServer is as a worker. Let&rsquo;s say that when a new user signs up for your service, you want to send them a welcome email, but you don&rsquo;t want to wait until that email is sent to return a successful account creation HTTP response to the user. You can send that email asynchronously like so<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>:</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir><span style=display:flex><span><span style=color:#c678dd>def</span> <span style=color:#c1abea>create_user</span>(<span style=color:#c1abea>user_details</span>) <span style=color:#c678dd>do</span>
</span></span><span style=display:flex><span>  <span style=color:#c1abea>user_details</span>
</span></span><span style=display:flex><span>  <span style=color:#c7bf54>|&gt;</span> <span style=color:#76a9f9>User</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>changeset</span>()
</span></span><span style=display:flex><span>  <span style=color:#c7bf54>|&gt;</span> <span style=color:#76a9f9>Repo</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>save</span>()
</span></span><span style=display:flex><span>  <span style=color:#c7bf54>|&gt;</span> <span style=color:#c678dd>case</span> <span style=color:#c678dd>do</span>
</span></span><span style=display:flex><span>    {<span style=color:#56b6c2>:ok</span>, <span style=color:#c1abea>user</span>} <span style=color:#c7bf54>-&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#76a9f9>GenServer</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>cast</span>(<span style=color:#76a9f9>MyApp.Mailer</span>, {<span style=color:#56b6c2>:send_welcome</span>, <span style=color:#c1abea>user</span>})
</span></span><span style=display:flex><span>      {<span style=color:#56b6c2>:ok</span>, <span style=color:#c1abea>user</span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#c1abea>error</span> <span style=color:#c7bf54>-&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#c1abea>error</span>
</span></span><span style=display:flex><span>  <span style=color:#c678dd>end</span>
</span></span><span style=display:flex><span><span style=color:#c678dd>end</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir><span style=display:flex><span><span style=color:#c678dd>defmodule</span> <span style=color:#76a9f9>MyApp.Mailer</span> <span style=color:#c678dd>do</span>
</span></span><span style=display:flex><span>  <span style=color:#c678dd>use</span> <span style=color:#76a9f9>GenServer</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8a93a5;font-style:italic># For example purposes, we assume the server does not have any meaningful</span>
</span></span><span style=display:flex><span>  <span style=color:#8a93a5;font-style:italic># internal state or on-start setup to do.</span>
</span></span><span style=display:flex><span>  <span style=color:#c678dd>def</span> <span style=color:#c1abea>init</span>(<span style=color:#c1abea>_</span>), <span style=color:#56b6c2>do</span>: {<span style=color:#56b6c2>:ok</span>, <span style=color:#b756ff;font-weight:700>nil</span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#c678dd>def</span> <span style=color:#c1abea>handle_cast</span>({<span style=color:#56b6c2>:send_welcome</span>, <span style=color:#c1abea>user</span>}, <span style=color:#c1abea>_from</span>, <span style=color:#c1abea>state</span>) <span style=color:#c678dd>do</span>
</span></span><span style=display:flex><span>    <span style=color:#c1abea>user</span>
</span></span><span style=display:flex><span>    <span style=color:#c7bf54>|&gt;</span> <span style=color:#c1abea>customize_welcome_email</span>()
</span></span><span style=display:flex><span>    <span style=color:#c7bf54>|&gt;</span> <span style=color:#b3d23c>@mail_api</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>send</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    {<span style=color:#56b6c2>:noreply</span>, <span style=color:#c1abea>state</span>}
</span></span><span style=display:flex><span>  <span style=color:#c678dd>end</span>
</span></span><span style=display:flex><span><span style=color:#c678dd>end</span>
</span></span></code></pre></div><p>Since <code>GenServer.cast</code> is asynchronous (sends a message and returns immediately, a behavior often termed &ldquo;fire and forget&rdquo;), the process invoking <code>create_user</code> will not wait for <code>MyApp.Mailer.handle_cast</code> to complete. Thus, control will return from <code>create_user</code> likely before the mailer ever tries to send the email.</p><h2 id=shared-mutable-state class="relative group">Shared, Mutable State <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#shared-mutable-state aria-label=Anchor>#</a></span></h2><p>BEAM languages do not, by default, have mutable data structures<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>. This means that if you have some list <code>x</code> and you wish to add an element to it, you will now have a new list <code>y</code>. Also, if <code>x</code> exists in Process A, the only way that Process B can read <code>x</code> is to receive a message from Process A containing <code>x</code>—though, notably, messages passing <em>copies</em> the data being sent; Process B does not receive a reference to data inside Process A.</p><p>GenServers allow developers to work within these limitations by:</p><ol><li>Functioning as a stable &ldquo;location&rdquo; (name or PID) where the data &ldquo;changes&rdquo; over time.</li><li>Functioning as a shared &ldquo;location&rdquo; where multiple processes can manipulate the same data.</li></ol><p>One would naturally believe that a mutable data store shared between any number of processes would lead to countless race conditions. However, many race conditions are mitigated by the fact that GenServers respond to requests sequentially.</p><p>For instance, let&rsquo;s imagine that we are creating a seat reservation system for a movie theater. When a user requests to reserve a seat, we want to:</p><ol><li>Verify that the requested seat is still available.</li><li>Process the user&rsquo;s payment.</li><li>Update the seat in our system to no longer be available.</li></ol><p>Consider this GenServer:</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir><span style=display:flex><span><span style=color:#c678dd>defmodule</span> <span style=color:#76a9f9>MyApp.SeatReservations</span> <span style=color:#c678dd>do</span>
</span></span><span style=display:flex><span>  <span style=color:#b3d23c>@moduledoc</span> <span style=color:#98c379>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#98c379>  A GenServer that keeps track of which seats are reserved.
</span></span></span><span style=display:flex><span><span style=color:#98c379>  &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#c678dd>use</span> <span style=color:#76a9f9>GenServer</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#c678dd>def</span> <span style=color:#c1abea>init</span>(<span style=color:#c1abea>_</span>) <span style=color:#c678dd>do</span>
</span></span><span style=display:flex><span>    {<span style=color:#56b6c2>:ok</span>, %{<span style=color:#56b6c2>reserved_seats</span>: []}}
</span></span><span style=display:flex><span>  <span style=color:#c678dd>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#c678dd>def</span> <span style=color:#c1abea>handle_call</span>({<span style=color:#56b6c2>:seat_available?</span>, <span style=color:#c1abea>seat</span>}, <span style=color:#c1abea>_from</span>, <span style=color:#c1abea>state</span>) <span style=color:#c678dd>do</span>
</span></span><span style=display:flex><span>    {<span style=color:#56b6c2>:reply</span>, <span style=color:#c1abea>seat</span> <span style=color:#b756ff;font-weight:700>in</span> <span style=color:#c1abea>state</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>reserved_seats</span>, <span style=color:#c1abea>state</span>}
</span></span><span style=display:flex><span>  <span style=color:#c678dd>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#c678dd>def</span> <span style=color:#c1abea>handle_call</span>({<span style=color:#56b6c2>:mark_reserved</span>, <span style=color:#c1abea>seat</span>}, <span style=color:#c1abea>_from</span>, <span style=color:#c1abea>state</span>) <span style=color:#c678dd>do</span>
</span></span><span style=display:flex><span>    <span style=color:#c1abea>updated_state</span> <span style=color:#c7bf54>=</span> <span style=color:#76a9f9>Map</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>update!</span>(<span style=color:#c1abea>state</span>, <span style=color:#56b6c2>:reserved_seats</span>, <span style=color:#c7bf54>&amp;</span>[<span style=color:#c1abea>seat</span> <span style=color:#c7bf54>|</span> <span style=color:#bda26f>&amp;1</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    {<span style=color:#56b6c2>:reply</span>, <span style=color:#56b6c2>:ok</span>, <span style=color:#c1abea>updated_state</span>}
</span></span><span style=display:flex><span>  <span style=color:#c678dd>end</span>
</span></span><span style=display:flex><span><span style=color:#c678dd>end</span>
</span></span></code></pre></div><p>Used like so:</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir><span style=display:flex><span><span style=color:#c678dd>def</span> <span style=color:#c1abea>reserve_seat</span>(<span style=color:#c1abea>seat</span>, <span style=color:#c1abea>user</span>) <span style=color:#c678dd>do</span>
</span></span><span style=display:flex><span>  <span style=color:#c678dd>if</span> <span style=color:#76a9f9>GenServer</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>call</span>(<span style=color:#76a9f9>MyApp.SeatReservations</span>, {<span style=color:#56b6c2>:seat_available?</span>, <span style=color:#c1abea>seat</span>}) <span style=color:#c678dd>do</span>
</span></span><span style=display:flex><span>    <span style=color:#c1abea>process_user_payment</span>(<span style=color:#c1abea>user</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#76a9f9>GenServer</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>call</span>(<span style=color:#76a9f9>MyApp.SeatReservations</span>, {<span style=color:#56b6c2>:mark_reserved</span>, <span style=color:#c1abea>seat</span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#56b6c2>:ok</span>
</span></span><span style=display:flex><span>  <span style=color:#c678dd>else</span>
</span></span><span style=display:flex><span>    {<span style=color:#56b6c2>:error</span>, <span style=color:#56b6c2>:taken</span>}
</span></span><span style=display:flex><span>  <span style=color:#c678dd>end</span>
</span></span><span style=display:flex><span><span style=color:#c678dd>end</span>
</span></span></code></pre></div><p>Using this implementation, a race condition can occur if two users requested the same seat at roughly the same time. Because the seat is not yet marked as reserved for the first user (payment processing takes time), the second user to request the seat would still see it as available, and both users would ultimately be able to reserve the same seat.</p><p>To solve this issue, we can move our <a href=https://en.wikipedia.org/wiki/Critical_section target=_blank rel=noreferrer>&ldquo;critical section&rdquo;</a> into the GenServer like so:</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir><span style=display:flex><span><span style=color:#c678dd>defmodule</span> <span style=color:#76a9f9>MyApp.ReservationServer</span> <span style=color:#c678dd>do</span>
</span></span><span style=display:flex><span>  <span style=color:#b3d23c>@moduledoc</span> <span style=color:#98c379>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#98c379>  A GenServer that handles reserving seats.
</span></span></span><span style=display:flex><span><span style=color:#98c379>  &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#c678dd>use</span> <span style=color:#76a9f9>GenServer</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#c678dd>def</span> <span style=color:#c1abea>init</span>(<span style=color:#c1abea>_</span>) <span style=color:#c678dd>do</span>
</span></span><span style=display:flex><span>    {<span style=color:#56b6c2>:ok</span>, %{<span style=color:#56b6c2>reserved_seats</span>: []}}
</span></span><span style=display:flex><span>  <span style=color:#c678dd>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#c678dd>def</span> <span style=color:#c1abea>handle_call</span>({<span style=color:#56b6c2>:reserve</span>, <span style=color:#c1abea>seat</span>, <span style=color:#c1abea>user</span>}, <span style=color:#c1abea>_from</span>, <span style=color:#c1abea>state</span>) <span style=color:#c678dd>do</span>
</span></span><span style=display:flex><span>    <span style=color:#c678dd>if</span> <span style=color:#c1abea>seat</span> <span style=color:#b756ff;font-weight:700>in</span> <span style=color:#c1abea>state</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>reserved_seats</span> <span style=color:#c678dd>do</span>
</span></span><span style=display:flex><span>      {<span style=color:#56b6c2>:reply</span>, {<span style=color:#56b6c2>:error</span>, <span style=color:#56b6c2>:taken</span>}, <span style=color:#c1abea>state</span>}
</span></span><span style=display:flex><span>    <span style=color:#c678dd>else</span>
</span></span><span style=display:flex><span>      <span style=color:#c1abea>process_user_payment</span>(<span style=color:#c1abea>user</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#c1abea>updated_state</span> <span style=color:#c7bf54>=</span> <span style=color:#76a9f9>Map</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>update!</span>(<span style=color:#c1abea>state</span>, <span style=color:#56b6c2>:reserved_seats</span>, <span style=color:#c7bf54>&amp;</span>[<span style=color:#c1abea>seat</span> <span style=color:#c7bf54>|</span> <span style=color:#bda26f>&amp;1</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      {<span style=color:#56b6c2>:reply</span>, <span style=color:#56b6c2>:ok</span>, <span style=color:#c1abea>updated_state</span>}
</span></span><span style=display:flex><span>    <span style=color:#c678dd>end</span>
</span></span><span style=display:flex><span>  <span style=color:#c678dd>end</span>
</span></span><span style=display:flex><span><span style=color:#c678dd>end</span>
</span></span></code></pre></div><p>And updated usage:</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir><span style=display:flex><span><span style=color:#c678dd>def</span> <span style=color:#c1abea>reserve_seat</span>(<span style=color:#c1abea>seat</span>, <span style=color:#c1abea>user</span>) <span style=color:#c678dd>do</span>
</span></span><span style=display:flex><span>  <span style=color:#76a9f9>GenServer</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>call</span>(<span style=color:#76a9f9>MyApp.ReservationServer</span>, {<span style=color:#56b6c2>:reserve</span>, <span style=color:#c1abea>seat</span>, <span style=color:#c1abea>user</span>})
</span></span><span style=display:flex><span><span style=color:#c678dd>end</span>
</span></span></code></pre></div><p>Because GenServers only processes one request at a time, this new GenServer will fully process one request before beginning the next. This means that if two users request the same seat at about the same time, <code>reserved_seats</code> <em>is</em> updated when the second user&rsquo;s request begins to be handled since the first user&rsquo;s request must have finished. Thus the second user will receive an error that the seat is already reserved (i.e. the correct behavior of the system).</p><h1 id=the-pit class="relative group">The Pit <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#the-pit aria-label=Anchor>#</a></span></h1><p>The default behavior of <code>GenServer.call</code> is to time out after five seconds by default, though the timeout can be set to any number of milliseconds or <code>:infinity</code>. When a <code>GenServer</code> fails to respond to a <code>call</code> within the timeout, an exception is raised in the calling process. Unfortunately, getting the timing right in GenServers is <em>difficult</em>. Among the reasons why a GenServer may not respond to a <code>GenServer.call</code> before timeout are:</p><ul><li>The callback for your request took too long. For instance, that callback may be making a call to an external API and their server is running particularly slowly today.</li><li>The GenServer is bogged down handling other requests. Since requests to GenServers are handled in first-in, first-out (FIFO) order, it is possible that the GenServer <em>never even got the chance to handle your request before timeout</em>.</li><li>A combination of the above—the GenServer started handling your request before timeout, but was delayed due to processing other messages first, and was unable to reply before timeout despite the callback&rsquo;s runtime being less than <code>timeout</code> milliseconds.</li></ul><p>One can easily imagine a situation where, using the code above, the payment processing step takes more than five seconds at least some of the time.</p><p><strong>There is no way to totally avoid this class of issue</strong>. Even a GenServer whose callbacks execute in microseconds can become bogged down by a sudden surge of requests.</p><p>In the last month, I&rsquo;ve experienced two different GenServer timing related production issues:</p><ul><li>A GenServer callback that <em>never</em> terminated because a library function called in my callback evidently doesn&rsquo;t ever terminate sometimes. The GenServer was effectively dead, but never restarted because it wasn&rsquo;t <em>actually</em> dead.</li><li>A GenServer callback that <em>sometimes</em> takes a while (it&rsquo;s calling an external API) and thus on those occasions later GenServer calls are timing out. The system took a while to recover.</li></ul><h1 id=a-partial-solution class="relative group">A Partial Solution <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#a-partial-solution aria-label=Anchor>#</a></span></h1><p>While this problem cannot be completely resolved, there is one way to constrain the runtime of GenServer callbacks and thus reduce the risk of timeouts: <a href=https://hexdocs.pm/elixir/Task.html target=_blank rel=noreferrer>Tasks</a>. Ideally, GenServers would have a built-in way to limit the allowable time for a GenServer callback&rsquo;s execution. Since there <em>isn&rsquo;t</em>, we can can make one ourselves:</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir><span style=display:flex><span><span style=color:#c678dd>def</span> <span style=color:#c1abea>handle_call</span>(<span style=color:#56b6c2>:foo</span>, <span style=color:#c1abea>_from</span>, <span style=color:#c1abea>state</span>) <span style=color:#c678dd>do</span>
</span></span><span style=display:flex><span>  <span style=color:#c1abea>task</span> <span style=color:#c7bf54>=</span>
</span></span><span style=display:flex><span>    <span style=color:#76a9f9>Task</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>async</span>(<span style=color:#c678dd>fn</span> <span style=color:#c7bf54>-&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#c1abea>slow_function</span>(<span style=color:#c1abea>state</span>)
</span></span><span style=display:flex><span>    <span style=color:#c678dd>end</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#c678dd>case</span> <span style=color:#76a9f9>Task</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>yield</span>(<span style=color:#c1abea>task</span>, <span style=color:#d19a66>4_000</span>) <span style=color:#c7bf54>||</span> <span style=color:#76a9f9>Task</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>shutdown</span>(<span style=color:#c1abea>task</span>) <span style=color:#c678dd>do</span>
</span></span><span style=display:flex><span>    {<span style=color:#56b6c2>:ok</span>, <span style=color:#c1abea>result</span>} <span style=color:#c7bf54>-&gt;</span>   {<span style=color:#56b6c2>:reply</span>, {<span style=color:#56b6c2>:ok</span>, <span style=color:#c1abea>result</span>}, <span style=color:#c1abea>state</span>}
</span></span><span style=display:flex><span>    {<span style=color:#56b6c2>:exit</span>, <span style=color:#c1abea>reason</span>} <span style=color:#c7bf54>-&gt;</span> {<span style=color:#56b6c2>:reply</span>, {<span style=color:#56b6c2>:error</span>, <span style=color:#c1abea>reason</span>}, <span style=color:#c1abea>state</span>}
</span></span><span style=display:flex><span>    <span style=color:#b756ff;font-weight:700>nil</span> <span style=color:#c7bf54>-&gt;</span>             {<span style=color:#56b6c2>:reply</span>, {<span style=color:#56b6c2>:error</span>, <span style=color:#56b6c2>:timeout</span>}, <span style=color:#c1abea>state</span>}
</span></span><span style=display:flex><span>  <span style=color:#c678dd>end</span>
</span></span><span style=display:flex><span><span style=color:#c678dd>end</span>
</span></span></code></pre></div><p>Let&rsquo;s break this down.</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir><span style=display:flex><span>  <span style=color:#c1abea>task</span> <span style=color:#c7bf54>=</span>
</span></span><span style=display:flex><span>    <span style=color:#76a9f9>Task</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>async</span>(<span style=color:#c678dd>fn</span> <span style=color:#c7bf54>-&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#c1abea>slow_function</span>(<span style=color:#c1abea>state</span>)
</span></span><span style=display:flex><span>    <span style=color:#c678dd>end</span>)
</span></span></code></pre></div><p>The first thing this callback does is begin a Task running <code>slow_function</code>. Here, <code>slow_function</code> is a placeholder for the work that is to be done in this GenServer&rsquo;s callback; everything else in this callback is about limiting the runtime (we&rsquo;ll reduce the boilerplate in a moment).</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir><span style=display:flex><span>  <span style=color:#c678dd>case</span> <span style=color:#76a9f9>Task</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>yield</span>(<span style=color:#c1abea>task</span>, <span style=color:#d19a66>4_000</span>) <span style=color:#c7bf54>||</span> <span style=color:#76a9f9>Task</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>shutdown</span>(<span style=color:#c1abea>task</span>) <span style=color:#c678dd>do</span>
</span></span><span style=display:flex><span>    {<span style=color:#56b6c2>:ok</span>, <span style=color:#c1abea>result</span>} <span style=color:#c7bf54>-&gt;</span>   {<span style=color:#56b6c2>:reply</span>, {<span style=color:#56b6c2>:ok</span>, <span style=color:#c1abea>result</span>}, <span style=color:#c1abea>state</span>}
</span></span><span style=display:flex><span>    {<span style=color:#56b6c2>:exit</span>, <span style=color:#c1abea>reason</span>} <span style=color:#c7bf54>-&gt;</span> {<span style=color:#56b6c2>:reply</span>, {<span style=color:#56b6c2>:error</span>, <span style=color:#c1abea>reason</span>}, <span style=color:#c1abea>state</span>}
</span></span><span style=display:flex><span>    <span style=color:#b756ff;font-weight:700>nil</span> <span style=color:#c7bf54>-&gt;</span>             {<span style=color:#56b6c2>:reply</span>, {<span style=color:#56b6c2>:error</span>, <span style=color:#56b6c2>:timeout</span>}, <span style=color:#c1abea>state</span>}
</span></span><span style=display:flex><span>  <span style=color:#c678dd>end</span>
</span></span></code></pre></div><p>The expression <code>Task.yield(task, 4_000) || Task.shutdown(task)</code> gives the task running <code>slow_function</code> (i.e. the callback&rsquo;s &ldquo;real&rdquo; work) 4,000ms to complete. The value of 4,000ms is somewhat arbitrary; but the central idea is that:</p><ol><li>It should probably be less than the default <code>GenServer.call</code> timeout of 5,000ms unless every caller is using a longer, custom timeout</li><li>It should probably leave some headroom to account for the fact that the <code>GenServer.call</code> timeout may have started counting down while a previous callback was being processed, and so this callback has <em>less</em> than the full 5,000ms to respond.</li></ol><p>You can tweak this timeout based on your system&rsquo;s needs.</p><p><code>Task.yield</code> and <code>Task.shutdown</code> have conveniently have the same return types:</p><ul><li><code>{:ok, reply}</code>: The Task completed and returned a value.</li><li><code>{:exit, reason}</code>: The Task died unexpectedly.</li><li><code>nil</code>: No reply was received.</li></ul><p>Here we&rsquo;re using <code>||</code> to essentially say &ldquo;If the Task hit its time limit, shut it down&rdquo;. Based on which result we receive here, we produce a corresponding reply for our GenServer.</p><p>OK, as promised, one can reduce the boilerplate by defining a helper function:</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir><span style=display:flex><span><span style=color:#c678dd>def</span> <span style=color:#c1abea>time_limited</span>(<span style=color:#c1abea>fun</span>, <span style=color:#c1abea>time_limit</span>) <span style=color:#c678dd>do</span>
</span></span><span style=display:flex><span>  <span style=color:#c1abea>task</span> <span style=color:#c7bf54>=</span> <span style=color:#76a9f9>Task</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>async</span>(<span style=color:#c1abea>fun</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#76a9f9>Task</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>yield</span>(<span style=color:#c1abea>task</span>, <span style=color:#c1abea>time_limit</span>) <span style=color:#c7bf54>||</span> <span style=color:#76a9f9>Task</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>shutdown</span>(<span style=color:#c1abea>task</span>)
</span></span><span style=display:flex><span><span style=color:#c678dd>end</span>
</span></span></code></pre></div><p>Used like so:</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir><span style=display:flex><span><span style=color:#c678dd>def</span> <span style=color:#c1abea>handle_call</span>(<span style=color:#56b6c2>:foo</span>, <span style=color:#c1abea>_from</span>, <span style=color:#c1abea>state</span>) <span style=color:#c678dd>do</span>
</span></span><span style=display:flex><span>  <span style=color:#c678dd>case</span> <span style=color:#c1abea>time_limited</span>(<span style=color:#c678dd>fn</span> <span style=color:#c7bf54>-&gt;</span> <span style=color:#c1abea>slow_function</span>(<span style=color:#c1abea>state</span>) <span style=color:#c678dd>end</span>, <span style=color:#d19a66>4_000</span>) <span style=color:#c678dd>do</span>
</span></span><span style=display:flex><span>    {<span style=color:#56b6c2>:ok</span>, <span style=color:#c1abea>result</span>} <span style=color:#c7bf54>-&gt;</span>   {<span style=color:#56b6c2>:reply</span>, {<span style=color:#56b6c2>:ok</span>, <span style=color:#c1abea>result</span>}, <span style=color:#c1abea>state</span>}
</span></span><span style=display:flex><span>    {<span style=color:#56b6c2>:exit</span>, <span style=color:#c1abea>reason</span>} <span style=color:#c7bf54>-&gt;</span> {<span style=color:#56b6c2>:reply</span>, {<span style=color:#56b6c2>:error</span>, <span style=color:#c1abea>reason</span>}, <span style=color:#c1abea>state</span>}
</span></span><span style=display:flex><span>    <span style=color:#b756ff;font-weight:700>nil</span> <span style=color:#c7bf54>-&gt;</span>             {<span style=color:#56b6c2>:reply</span>, {<span style=color:#56b6c2>:error</span>, <span style=color:#56b6c2>:timeout</span>}, <span style=color:#c1abea>state</span>}
</span></span><span style=display:flex><span>  <span style=color:#c678dd>end</span>
</span></span><span style=display:flex><span><span style=color:#c678dd>end</span>
</span></span></code></pre></div><p>To cut down boilerplate even further, you can customize this for GenServers (create the <code>{:reply, ..., ...}</code> tuples inside <code>time_limited</code>) or write a macro.</p><p>One caveat to note here is that spawning a Task is going to consume additional resources—most notably memory. As noted above, when one process sends a message to another, the data in that message is <em>copied</em> between the processes. This also applies to spawning new processes: the data you are spawning the new process with is copied into that process. Consider a typical GenServer interaction with the above pattern:</p><ol><li>Process P sends a message to GenServer G</li><li>G spawns Task T.</li></ol><p>Let&rsquo;s conjecture that P is sending data needed to fulfill the GenServer&rsquo;s callback. Therefore:</p><ul><li>The original data exists in P</li><li>The data is copied from P to G with <code>GenServer.call</code></li><li>The data is copied from G to T with <code>Task.async</code></li></ul><p>Therefore there are three total copies of this data. If the data in question is small, such as an atom or integer, this is not of much concern. <em>However</em>, if the data is larger, say a struct with a large number of fields or nested structures, creating two additional copies of that data may consume more memory than you would be comfortable allocating.</p><p>It is, as a general note, a best practice to send as little data in messages as possible for this reason (e.g. send an ID that can be used to fetch a struct rather than the struct itself).</p><h1 id=in-sum class="relative group">In Sum <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#in-sum aria-label=Anchor>#</a></span></h1><p>You can mitigate the problem of long-running GenServer callbacks causing timeouts within your system by wrapping the functionality of the callback in a time-limited Task. To this end, I believe that one should generally <em>default</em> to time-limiting GenServer callbacks, unless you have a good reason not to<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>. It&rsquo;s a bit of boilerplate and additional memory overhead, but when used thoughtfully it&rsquo;ll save you from production headaches in the long run.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Generally speaking, you should wrap <code>GenServer.cast</code> and <code>GenServer.call</code> invocations in another function, e.g.</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir><span style=display:flex><span><span style=color:#c678dd>def</span> <span style=color:#c1abea>send_welcome_email</span>(<span style=color:#c1abea>user</span>) <span style=color:#c678dd>do</span>
</span></span><span style=display:flex><span>  <span style=color:#76a9f9>GenServer</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>cast</span>(<span style=color:#76a9f9>MyApp.Mailer</span>, {<span style=color:#56b6c2>:send_welcome</span>, <span style=color:#c1abea>user</span>})
</span></span><span style=display:flex><span><span style=color:#c678dd>end</span>
</span></span></code></pre></div><p>The rationale for this indirection is that the implementations for these types of operations are often subject to change. For instance, sending the welcome email might later be performed by a <a href=https://hexdocs.pm/elixir/Task.html target=_blank rel=noreferrer>Task</a> instead. If that were the case, and our application is sending emails via this <code>send_welcome_email/1</code> function, we wouldn&rsquo;t need to update everywhere that sends an email to use a Task, we&rsquo;d only need to update <code>send_welcome_email/1</code>.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>You can make a mutable data structure using natively implemented functions (&ldquo;NIFs&rdquo;), but this is not commonly done.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>There are some use cases for GenServer to run time-unbounded callbacks, such as async workers. It&rsquo;s a somewhat niche use case, however, since if the GenServer crashes for any reason (or the node goes down), the GenServer&rsquo;s work queue is lost. A better option would be to opt for a persistence-backed worker such as <a href=https://hexdocs.pm/oban/Oban.html target=_blank rel=noreferrer>Oban</a>.&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div></section><footer class="max-w-prose pt-8 print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="group flex" href=https://j3rn.com/posts/api-integration-design/><span class="me-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"><span class="ltr:inline rtl:hidden">&larr;</span><span class="ltr:hidden rtl:inline">&rarr;</span></span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">My API Integration Methodology</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2025-07-27 00:00:00 +0000 UTC">July 27, 2025</time>
</span></span></a></span><span></span></div></div></footer></article></main><div class="pointer-events-none absolute bottom-0 end-0 top-[100vh] w-12" id=to-top hidden=true><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div><footer class="py-10 print:hidden"><div class="flex items-center justify-between"><div><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2025
Jonathan Arnett</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://github.com/jpanther/congo target=_blank rel="noopener noreferrer">Congo</a></p></div><div class="flex flex-row items-center"><div class="me-14 cursor-pointer text-sm text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"><button id=appearance-switcher-0 type=button aria-label="appearance switcher"><div class="flex h-12 w-12 items-center justify-center dark:hidden" title="Switch to dark appearance"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="hidden h-12 w-12 items-center justify-center dark:flex" title="Switch to light appearance"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div></div></footer><div id=search-wrapper class="invisible fixed inset-0 z-50 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]" data-url=https://j3rn.com/><div id=search-modal class="top-20 mx-auto flex min-h-0 w-full max-w-3xl flex-col rounded-md border border-neutral-200 bg-neutral shadow-lg dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex flex-none items-center justify-between px-2"><form class="flex min-w-0 flex-auto items-center"><div class="flex h-8 w-8 items-center justify-center text-neutral-400"><span class="icon relative inline-block px-1 align-text-bottom"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="mx-1 flex h-12 flex-auto appearance-none bg-transparent focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex h-8 w-8 items-center justify-center text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto overflow-auto px-2"><ul id=search-results></ul></section></div></div></div></body></html>